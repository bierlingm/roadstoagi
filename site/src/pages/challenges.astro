---
import Base from "../layouts/Base.astro";
import { loadChallenges } from "../lib/loaders.js";

const challenges = loadChallenges();
const openChallenges = challenges.filter(c => c.status === "open");
const resolvedChallenges = challenges.filter(c => c.status === "resolved");
---
<Base 
  title="Challenges"
  description="Think a claim is wrong? Challenge it with evidence. Active challenges and resolutions in the Roads to AGI arena."
>
  <div class="container">
    <header class="page-header">
      <h1>Challenges</h1>
      <p class="muted">
        Think a claim is wrong? Challenge it with evidence. Claims that survive challenges are stronger. Claims that fail get marked.
      </p>
    </header>

    <div class="stats-row">
      <div class="stat-card card">
        <div class="stat-value">{openChallenges.length}</div>
        <div class="stat-label">Open</div>
      </div>
      <div class="stat-card card">
        <div class="stat-value">{resolvedChallenges.length}</div>
        <div class="stat-label">Resolved</div>
      </div>
    </div>

    <section class="section">
      <h2>Open Challenges</h2>
      {openChallenges.length === 0 ? (
        <p class="muted">No open challenges yet. Be the first to challenge a claim.</p>
      ) : (
        <div class="challenges-list stack-sm">
          {openChallenges.map(ch => (
            <div class="challenge-card card">
              <span class="mono">{ch.id}</span>
              <span class="dim">→</span>
              <span class="mono">{ch.target}</span>
              <span class="tag">{ch.type}</span>
            </div>
          ))}
        </div>
      )}
    </section>

    {resolvedChallenges.length > 0 && (
      <section class="section">
        <h2>Resolved</h2>
        <div class="challenges-list stack-sm">
          {resolvedChallenges.map(ch => (
            <div class="challenge-card card resolved">
              <span class="mono">{ch.id}</span>
              <span class="dim">→</span>
              <span class="mono">{ch.target}</span>
              <span class="tag">{ch.type}</span>
            </div>
          ))}
        </div>
      </section>
    )}

    <section class="submit-section card">
      <h3>Challenge a Claim</h3>
      <p class="muted">
        To challenge a claim, you need:
      </p>
      <ul class="requirements">
        <li>The claim ID you're challenging (e.g., C-0001)</li>
        <li>Your challenge type (counterexample, missing evidence, scope problem, etc.)</li>
        <li>Your evidence or argument</li>
      </ul>
      <p>
        Email <a href="mailto:challenges@roadstoagi.org">challenges@roadstoagi.org</a> with your challenge.
      </p>
    </section>
  </div>
</Base>

<style>
  .page-header {
    margin-bottom: var(--space-8);
  }

  .page-header h1 {
    margin-bottom: var(--space-2);
  }

  .stats-row {
    display: flex;
    gap: var(--space-6);
    margin-bottom: var(--space-8);
  }

  .stat-card {
    flex: 1;
    text-align: center;
    padding: var(--space-6);
  }

  .stat-value {
    font-size: var(--fs-2xl);
    font-weight: 700;
  }

  .stat-label {
    color: var(--muted);
    font-size: var(--fs-sm);
  }

  .section {
    margin: var(--space-8) 0;
  }

  .section h2 {
    margin-bottom: var(--space-4);
  }

  .challenge-card {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-4);
  }

  .challenge-card.resolved {
    opacity: 0.6;
  }

  .submit-section {
    margin-top: var(--space-10);
  }

  .submit-section h3 {
    margin-bottom: var(--space-3);
  }

  .requirements {
    padding-left: var(--space-6);
    margin: var(--space-4) 0;
    color: var(--fg-2);
  }

  .requirements li {
    margin-bottom: var(--space-2);
  }
</style>
